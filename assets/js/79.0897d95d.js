(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{293:function(t,s,a){"use strict";a.r(s);var r=a(0),n=Object(r.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"什么是路由？"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是路由？"}},[t._v("#")]),t._v(" 什么是路由？")]),t._v(" "),a("p",[t._v("路由是根据不同的"),a("strong",[t._v("url")]),t._v("地址展示不同的内容或页面。 一个针对React而设计的路由解决方案、可以友好的帮你解决"),a("strong",[t._v("React components")]),t._v(" 到 "),a("strong",[t._v("URl")]),t._v("之间的"),a("strong",[t._v("同步映射")]),t._v("关系。")]),t._v(" "),a("p",[t._v("示例网站：\n"),a("a",{attrs:{href:"https://reactrouter.com/web/example/basic",target:"_blank",rel:"noopener noreferrer"}},[t._v("react-router示例"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"路由安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由安装"}},[t._v("#")]),t._v(" 路由安装")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("npm install react‐router‐dom\n")])])]),a("h2",{attrs:{id:"路由使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由使用"}},[t._v("#")]),t._v(" 路由使用")]),t._v(" "),a("ol",[a("li",[t._v("路由导入")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwgdf751ej30za0f276k.jpg",alt:"路由导入方法"}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("定义路由及重定向")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwgh1bgajj30yw0ow79n.jpg",alt:"定义路由及重定向"}})]),t._v(" "),a("p",[t._v("使用"),a("strong",[t._v("Redirect")]),t._v("进行路由"),a("strong",[t._v("重定向匹配")]),t._v("，由于是贪婪匹配，在上面例子中，如果"),a("strong",[t._v("已经匹配")]),t._v("到了"),a("strong",[t._v("center")]),t._v("路由，此时刷新页面会继续匹配到**/**根路由。")]),t._v(" "),a("p",[t._v("所以一般在使用"),a("strong",[t._v("HashRouter")]),t._v("时配套使用"),a("strong",[t._v("Switch")]),t._v("，匹配到路由之后立马跳出，只能匹配到第一个符合条件的路由。")]),t._v(" "),a("h2",{attrs:{id:"hashrouter与browserrouter的异同"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hashrouter与browserrouter的异同"}},[t._v("#")]),t._v(" HashRouter与BrowserRouter的异同")]),t._v(" "),a("p",[t._v("HashRouter的特点："),a("strong",[t._v("localhost:3000/#/film")])]),t._v(" "),a("ol",[a("li",[a("p",[t._v("HashRouter在路径中包含了**#"),a("strong",[t._v("，相当于锚点定位，因此不论")]),t._v("#**后面的路径怎么变化，请求的都相当于是#之前的那个页面，可以很容易的进行前后端不分离的部署(也就是把前端打包后的文件放到服务器端的public或static里)。")])]),t._v(" "),a("li",[a("p",[t._v("这个警告只有在hash 模式会出现(因为Hash模式下，默认浏览器不会记录重复点击的路由记录)，在NavLink 加上 replace 来解决，但轻易不要使用。（此警告并无大碍）")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwgtbgjizj314608kjt8.jpg",alt:""}})]),t._v(" "),a("p",[t._v("BrowserRouter的特点也是弊端："),a("strong",[t._v("localhost:3000/flim")])]),t._v(" "),a("p",[t._v("因为BrowserRouter模式下请求的链接都是ip地址: 端口/xxxx/xxxx，因此相当于每个URL都会访问一个不同的后端地址，如果后端没有覆盖到路由就会产生404错误。")]),t._v(" "),a("p",[a("b",[t._v("解决方案")]),t._v("：加入中间件解决，放在服务器端路由匹配的最后，如果前面的API接口都不匹配，则返回index. html页面。但这样也有一些小问题，因为要求前端路由和后端路由的URL不能重复。")]),t._v(" "),a("p",[t._v("比如商品列表组件叫/product/list，而请求商品列表的API也是/product/list，那么就会访问不到页面，而是被API接口匹配到。")]),t._v(" "),a("h2",{attrs:{id:"嵌套路由-父子关系的路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#嵌套路由-父子关系的路由"}},[t._v("#")]),t._v(" 嵌套路由(父子关系的路由)")]),t._v(" "),a("p",[t._v("定义在 src/Router/index. js 根路由里，当路由组件多的时候不利于维护")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwj4uqz0ej317s0u0wm6.jpg",alt:""}})]),t._v(" "),a("p",[t._v("所以我们最好在，父子路由需要嵌套的时候，把"),a("strong",[t._v("子路由写在父路由里")]),t._v("，比如，我写的组件顺序是"),a("strong",[t._v("App、Film(Nowplaying, Comingsoon)、Cinema、Center")]),t._v("，"),a("strong",[t._v("flim")]),t._v("路由包括"),a("strong",[t._v("nowplaying，comingsoon")]),t._v("路由，我们就把这两个分路由，定义在"),a("strong",[t._v("flim")]),t._v("路由组件里。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwjlvm6l1j31a20ii0ws.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"路由跳转方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由跳转方式"}},[t._v("#")]),t._v(" 路由跳转方式")]),t._v(" "),a("ol",[a("li",[t._v("声明式导航 "),a("strong",[t._v("NavLink")]),t._v("根据className判断自带高亮效果")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwjnsr5xqj31a80c8whj.jpg",alt:"声明式导航"}})]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("编程式导航：通过**this.props.history.push()**跳转路由")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwk005tydj30vi0aewg0.jpg",alt:"编程式导航"}})]),t._v(" "),a("p",[a("b",[t._v("如果想要做"),a("strong",[t._v("列表页路由跳转详情页面路由")])]),t._v("，步骤是：")]),t._v(" "),a("ol",[a("li",[t._v("先在列表页"),a("strong",[t._v("nowplaying")]),t._v("取得每条信息的"),a("strong",[t._v("id")]),t._v("值，")]),t._v(" "),a("li",[t._v("在根路由配置 "),a("strong",[t._v("详情页面的")]),t._v("的"),a("strong",[t._v("myid")])]),t._v(" "),a("li",[t._v("根据不同的"),a("strong",[t._v("myid")]),t._v("跳转不同的详情页路由")])]),t._v(" "),a("p",[t._v("步骤1：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwk005tydj30vi0aewg0.jpg",alt:"编程式导航"}})]),t._v(" "),a("p",[t._v("步骤2：\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwk44ks59j31a00ag0un.jpg",alt:""}})]),t._v(" "),a("p",[t._v("步骤3：\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwlbybd2bj31a80jgtct.jpg",alt:""}})]),t._v(" "),a("blockquote",[a("p",[t._v("注释：\n此时的"),a("strong",[t._v("myid")]),t._v("属性，是由根路由层，包裹的"),a("strong",[t._v("Route")]),t._v("传递过来的，而并非"),a("strong",[t._v("父亲组件传递")]),t._v("\n此时的"),a("strong",[t._v("myid")]),t._v("属性，是列表页(nowplaying) map遍历的数组每一项")])]),t._v(" "),a("p",[t._v("使用React-devtools扩展工具，可以看到"),a("strong",[t._v("myid")]),t._v("是从最一开始的"),a("strong",[t._v("Route")]),t._v("包裹传递的。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwlhujg8wj31fp0u0gud.jpg",alt:""}}),t._v(" "),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwlks4nd3j30k5027aac.jpg",alt:""}})]),t._v(" "),a("p",[a("b",[t._v("我们再来看一下，Route")]),t._v("还能给它包裹的组件传递什么东西？\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghwlq1i6wbj318y0u047d.jpg",alt:""}})]),t._v(" "),a("ul",[a("li",[t._v("this. props. history. go(-1)  回到上一个页面 ，回退几层")]),t._v(" "),a("li",[t._v("this. props. history. goBack( ) 回退页面")]),t._v(" "),a("li",[t._v("this. props. history. goForward( ) 前进页面")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghxelspacbj30p60iq79w.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"公共组件抽离之后的路由跳转"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#公共组件抽离之后的路由跳转"}},[t._v("#")]),t._v(" 公共组件抽离之后的路由跳转")]),t._v(" "),a("h3",{attrs:{id:"方法一-父组件传值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法一-父组件传值"}},[t._v("#")]),t._v(" 方法一 - 父组件传值")]),t._v(" "),a("p",[t._v("遇到上图这种的，正在热映模块和即将上映模块结构类似的组件时，我们可以把"),a("strong",[t._v("nowplaying和comingsoon")]),t._v("组件中，重复的"),a("strong",[t._v("li")]),t._v("部分提取成公共组件"),a("strong",[t._v("FilmItem")]),t._v("后，再引入时，就需要在"),a("strong",[t._v("FilmItem")]),t._v("组件上再次传递"),a("strong",[t._v("this. props. history")]),t._v("属性")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghxe4c9crrj31as0q8wj5.jpg",alt:""}})]),t._v(" "),a("p",[t._v("当然也可以简写成")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("FilmItem key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" item"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("item"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("FilmItem"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),a("p",[t._v("这样我们又可以在封装之后的"),a("strong",[t._v("FilmItem")]),t._v("里继续跳转路由了\n"),a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghxe6d4dq0j31a80hin0g.jpg",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"方法二-高阶组件（withrouter）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法二-高阶组件（withrouter）"}},[t._v("#")]),t._v(" 方法二 - 高阶组件（withRouter）")]),t._v(" "),a("p",[t._v("在后面。我们会详细介绍高阶组件，可以简单理解为 "),a("strong",[t._v("高阶组件")]),t._v("为其包裹组件包裹生成了一个"),a("strong",[t._v("干爹组件")]),t._v("，把需要的属性，我们传递进来。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghxevni3l4j316k0n6jwa.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"路由传参"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由传参"}},[t._v("#")]),t._v(" 路由传参")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("）\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" history"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" pathname "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/user'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" query "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" day"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Friday'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过下面这个接收到参数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" day\n\n（"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("）\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" history"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" pathname"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("day "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Friday'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过下面这个接收到参数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" location"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" day\n")])])]),a("p",[t._v("不建议使用上面这两种传参方式，因为当我们做单页面应用SPA时，这些参数变量，会存储在"),a("strong",[t._v("内存")]),t._v("中，页面刷新会丢失。")]),t._v(" "),a("p",[t._v("还是建议使用"),a("strong",[t._v("动态路由传参")]),t._v("。")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" history"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("detail"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 通过下面这个接收到参数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" match"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" params"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" myid\n")])])]),a("p",[t._v("注意这个"),a("strong",[t._v("myid")]),t._v("，是我在根路由中配置的。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghxfgz9eu7j31a00aggmq.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"路由拦截"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由拦截"}},[t._v("#")]),t._v(" 路由拦截")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghxfpx7ezej314g0b2ac5.jpg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"withrouter的应用于原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#withrouter的应用于原理"}},[t._v("#")]),t._v(" withRouter的应用于原理")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://tva1.sinaimg.cn/large/007S8ZIlly1ghxfr8jczsj315a0bujtq.jpg",alt:""}})])])}),[],!1,null,null,null);s.default=n.exports}}]);